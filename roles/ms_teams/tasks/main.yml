---
- name: Add Microsoft Teams GPG key
  shell: curl https://packages.microsoft.com/keys/microsoft.asc | sudo apt-key add -

- name: Add teams stable repository
  become: true
  blockinfile:
    path: /etc/apt/sources.list.d/teams.list
    marker: "# {mark} TEAMS SETTINGS - ANSIBLE MANAGED BLOCK"
    block: |
      deb [arch=amd64] https://packages.microsoft.com/repos/ms-teams stable main
    create: true
  notify: apt_update

- meta: flush_handlers

- name: Install teams
  become: true
  apt:
    name: teams
    state: present
